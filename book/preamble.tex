% preamble.tex — Editorial style (O'Reilly/Packt-inspired)
\usepackage{graphicx}
\usepackage{geometry}
\usepackage{xcolor}
\usepackage{microtype}
\usepackage{bookmark}
\usepackage{hyperref}
\usepackage{titlesec}
\usepackage{setspace}

% ========================
% Brand palette
% ========================
\definecolor{BrandBlue}{HTML}{0B1F33}      % Azul Profundo
\definecolor{BrandGraphite}{HTML}{0F172A}  % Grafite
\definecolor{BrandWhite}{HTML}{F8FAFC}     % Branco
\definecolor{BrandGray}{HTML}{64748B}      % Cinza

% ========================
% Reading comfort (global)
% ========================
\microtypesetup{protrusion=true, expansion=true}
\color{BrandGraphite}

% Parágrafos (livro longo: confortável e limpo)
\setlength{\parindent}{1.2em}
\setlength{\parskip}{0.25em}

% Evita "viúvas e órfãs" em texto longo
\widowpenalty=10000
\clubpenalty=10000

% Melhor hifenização/justificação
\tolerance=1200
\emergencystretch=1.5em

% ========================
% Headings (Packt-like: clean, subtle color)
% ========================
\titleformat{\chapter}
  {\normalfont\huge\bfseries\color{BrandBlue}}
  {\thechapter}{0.8em}{}

\titlespacing*{\chapter}{0pt}{-0.5em}{1.2em}

\titleformat{\section}
  {\normalfont\Large\bfseries\color{BrandBlue}}
  {\thesection}{0.8em}{}

\titleformat{\subsection}
  {\normalfont\large\bfseries\color{BrandGraphite}}
  {\thesubsection}{0.8em}{}

\titleformat{\subsubsection}
  {\normalfont\normalsize\bfseries\color{BrandGraphite}}
  {\thesubsubsection}{0.8em}{}

% ========================
% Links (discretos, editoriais)
% ========================
% O template do Quarto/Pandoc costuma sobrescrever hypersetup depois.
% Então aplicamos novamente no começo do documento.
\AtBeginDocument{%
  \hypersetup{
    colorlinks=true,
    linkcolor=BrandBlue,
    urlcolor=BrandBlue,
    citecolor=BrandBlue
  }%
}

% ========================
% Remove auto title block (se aparecer)
% ========================
\renewcommand{\maketitle}{}

% ========================
% Insert cover as first page
% ========================
\AtBeginDocument{%
  \begingroup
  \input{cover.tex}
  \endgroup
}

% Fix empty PDF bookmarks
\usepackage{bookmark}
\bookmarksetup{
  numbered,
  open,
  depth=3
}